// --- DOM Elements ---
const guessesEl = document.getElementById('guesses') as HTMLDivElement;
const keyboardEl = document.getElementById('keyboard') as HTMLDivElement;
const messageEl = document.getElementById('message') as HTMLDivElement;
const newGameButton = document.getElementById('new-game-button') as HTMLButtonElement;

// --- Game Constants & State ---
const WORD_LENGTH: number = 5; // กำหนดความยาวคำที่ต้องการ
const MAX_GUESSES: number = 6;
let secretWord: string = '';
let currentGuess: string = '';
let currentRow: number = 0;
let gameEnded: boolean = false;

// --- คลังคำศัพท์ของคุณเอง (ในไฟล์ script.ts โดยตรง) ---
// **สำคัญ:** คำศัพท์ต้องเป็นตัวพิมพ์ใหญ่ และมีความยาวตรงกับ WORD_LENGTH
const ALL_WORDS: string[] = // This file is auto-generated by scripts/generate-wordlist.js
[
    "ABACK",
    "ABASE",
    "ABATE",
    "ABBEY",
    "ABBOT",
    "ABHOR",
    "ABIDE",
    "ABLED",
    "ABODE",
    "ABORT",
    "ABOUT",
    "ABOVE",
    "ABUSE",
    "ABYSS",
    "ACORN",
    "ACRID",
    "ACTOR",
    "ACUTE",
    "ADAGE",
    "ADAPT",
    "ADEPT",
    "ADMIN",
    "ADMIT",
    "ADOBE",
    "ADOPT",
    "ADORE",
    "ADORN",
    "ADULT",
    "AFFIX",
    "AFIRE",
    "AFOOT",
    "AFOUL",
    "AFTER",
    "AGAIN",
    "AGAPE",
    "AGATE",
    "AGENT",
    "AGILE",
    "AGING",
    "AGLOW",
    "AGONY",
    "AGORA",
    "AGREE",
    "AHEAD",
    "AIDER",
    "AISLE",
    "ALARM",
    "ALBUM",
    "ALERT",
    "ALGAE",
    "ALIBI",
    "ALIEN",
    "ALIGN",
    "ALIKE",
    "ALIVE",
    "ALLAY",
    "ALLEY",
    "ALLOT",
    "ALLOW",
    "ALLOY",
    "ALOFT",
    "ALONE",
    "ALONG",
    "ALOOF",
    "ALOUD",
    "ALPHA",
    "ALTAR",
    "ALTER",
    "AMASS",
    "AMAZE",
    "AMBER",
    "AMBLE",
    "AMEND",
    "AMISS",
    "AMITY",
    "AMONG",
    "AMPLE",
    "AMPLY",
    "AMUSE",
    "ANGEL",
    "ANGER",
    "ANGLE",
    "ANGRY",
    "ANGST",
    "ANIME",
    "ANKLE",
    "ANNEX",
    "ANNOY",
    "ANNUL",
    "ANODE",
    "ANTIC",
    "ANVIL",
    "AORTA",
    "APART",
    "APHID",
    "APING",
    "APNEA",
    "APPLE",
    "APPLY",
    "APRON",
    "APTLY",
    "ARBOR",
    "ARDOR",
    "ARENA",
    "ARGUE",
    "ARISE",
    "ARMOR",
    "AROMA",
    "AROSE",
    "ARRAY",
    "ARROW",
    "ARSON",
    "ARTSY",
    "ASCOT",
    "ASHEN",
    "ASIDE",
    "ASKEW",
    "ASSAY",
    "ASSET",
    "ATOLL",
    "ATONE",
    "ATTIC",
    "AUDIO",
    "AUDIT",
    "AUGUR",
    "AUNTY",
    "AVAIL",
    "AVERT",
    "AVIAN",
    "AVOID",
    "AWAIT",
    "AWAKE",
    "AWARD",
    "AWARE",
    "AWASH",
    "AWFUL",
    "AWOKE",
    "AXIAL",
    "AXIOM",
    "AXION",
    "AZURE",
    "BACON",
    "BADGE",
    "BADLY",
    "BAGEL",
    "BAGGY",
    "BAKER",
    "BALER",
    "BALMY",
    "BANAL",
    "BANJO",
    "BARGE",
    "BARON",
    "BASAL",
    "BASIC",
    "BASIL",
    "BASIN",
    "BASIS",
    "BASTE",
    "BATCH",
    "BATHE",
    "BATON",
    "BATTY",
    "BAWDY",
    "BAYOU",
    "BEACH",
    "BEADY",
    "BEARD",
    "BEAST",
    "BEECH",
    "BEEFY",
    "BEFIT",
    "BEGAN",
    "BEGAT",
    "BEGET",
    "BEGIN",
    "BEGUN",
    "BEING",
    "BELCH",
    "BELIE",
    "BELLE",
    "BELLY",
    "BELOW",
    "BENCH",
    "BERET",
    "BERRY",
    "BERTH",
    "BESET",
    "BETEL",
    "BEVEL",
    "BEZEL",
    "BIBLE",
    "BICEP",
    "BIDDY",
    "BIGOT",
    "BILGE",
    "BILLY",
    "BINGE",
    "BINGO",
    "BIOME",
    "BIRCH",
    "BIRTH",
    "BISON",
    "BITTY",
    "BLACK",
    "BLADE",
    "BLAME",
    "BLAND",
    "BLANK",
    "BLARE",
    "BLAST",
    "BLAZE",
    "BLEAK",
    "BLEAT",
    "BLEED",
    "BLEEP",
    "BLEND",
    "BLESS",
    "BLIMP",
    "BLIND",
    "BLINK",
    "BLISS",
    "BLITZ",
    "BLOAT",
    "BLOCK",
    "BLOKE",
    "BLOND",
    "BLOOD",
    "BLOOM",
    "BLOWN",
    "BLUER",
    "BLUFF",
    "BLUNT",
    "BLURB",
    "BLURT",
    "BLUSH",
    "BOARD",
    "BOAST",
    "BOBBY",
    "BONEY",
    "BONGO",
    "BONUS",
    "BOOBY",
    "BOOST",
    "BOOTH",
    "BOOTY",
    "BOOZE",
    "BOOZY",
    "BORAX",
    "BORNE",
    "BOSOM",
    "BOSSY",
    "BOTCH",
    "BOUGH",
    "BOULE",
    "BOUND",
    "BOWEL",
    "BOXER",
    "BRACE",
    "BRAID",
    "BRAIN",
    "BRAKE",
    "BRAND",
    "BRASH",
    "BRASS",
    "BRAVE",
    "BRAVO",
    "BRAWL",
    "BRAWN",
    "BREAD",
    "BREAK",
    "BREED",
    "BRIAR",
    "BRIBE",
    "BRICK",
    "BRIDE",
    "BRIEF",
    "BRINE",
    "BRING",
    "BRINK",
    "BRINY",
    "BRISK",
    "BROAD",
    "BROIL",
    "BROKE",
    "BROOD",
    "BROOK",
    "BROOM",
    "BROTH",
    "BROWN",
    "BRUNT",
    "BRUSH",
    "BRUTE",
    "BUDDY",
    "BUDGE",
    "BUGGY",
    "BUGLE",
    "BUILD",
    "BUILT",
    "BULGE",
    "BULKY",
    "BULLY",
    "BUNCH",
    "BUNNY",
    "BURLY",
    "BURNT",
    "BURST",
    "BUSED",
    "BUSHY",
    "BUTCH",
    "BUTTE",
    "BUXOM",
    "BUYER",
    "BYLAW",
    "CABAL",
    "CABBY",
    "CABIN",
    "CABLE",
    "CACAO",
    "CACHE",
    "CACTI",
    "CADDY",
    "CADET",
    "CAGEY",
    "CAIRN",
    "CAMEL",
    "CAMEO",
    "CANAL",
    "CANDY",
    "CANNY",
    "CANOE",
    "CANON",
    "CAPER",
    "CAPUT",
    "CARAT",
    "CARGO",
    "CAROL",
    "CARRY",
    "CARVE",
    "CASTE",
    "CATCH",
    "CATER",
    "CATTY",
    "CAULK",
    "CAUSE",
    "CAVIL",
    "CEASE",
    "CEDAR",
    "CELLO",
    "CHAFE",
    "CHAFF",
    "CHAIN",
    "CHAIR",
    "CHALK",
    "CHAMP",
    "CHANT",
    "CHAOS",
    "CHARD",
    "CHARM",
    "CHART",
    "CHASE",
    "CHASM",
    "CHEAP",
    "CHEAT",
    "CHECK",
    "CHEEK",
    "CHEER",
    "CHESS",
    "CHEST",
    "CHICK",
    "CHIDE",
    "CHIEF",
    "CHILD",
    "CHILI",
    "CHILL",
    "CHIME",
    "CHINA",
    "CHIRP",
    "CHOCK",
    "CHOIR",
    "CHOKE",
    "CHORD",
    "CHORE",
    "CHOSE",
    "CHUCK",
    "CHUMP",
    "CHUNK",
    "CHURN",
    "CHUTE",
    "CIDER",
    "CIGAR",
    "CINCH",
    "CIRCA",
    "CIVIC",
    "CIVIL",
    "CLACK",
    "CLAIM",
    "CLAMP",
    "CLANG",
    "CLANK",
    "CLASH",
    "CLASP",
    "CLASS",
    "CLEAN",
    "CLEAR",
    "CLEAT",
    "CLEFT",
    "CLERK",
    "CLICK",
    "CLIFF",
    "CLIMB",
    "CLING",
    "CLINK",
    "CLOAK",
    "CLOCK",
    "CLONE",
    "CLOSE",
    "CLOTH",
    "CLOUD",
    "CLOUT",
    "CLOVE",
    "CLOWN",
    "CLUCK",
    "CLUED",
    "CLUMP",
    "CLUNG",
    "COACH",
    "COAST",
    "COBRA",
    "COCOA",
    "COLON",
    "COLOR",
    "COMET",
    "COMFY",
    "COMIC",
    "COMMA",
    "CONCH",
    "CONDO",
    "CONIC",
    "COPSE",
    "CORAL",
    "CORER",
    "CORNY",
    "COUCH",
    "COUGH",
    "COULD",
    "COUNT",
    "COUPE",
    "COURT",
    "COVEN",
    "COVER",
    "COVET",
    "COVEY",
    "COWER",
    "COYLY",
    "CRACK",
    "CRAFT",
    "CRAMP",
    "CRANE",
    "CRANK",
    "CRASH",
    "CRASS",
    "CRATE",
    "CRAVE",
    "CRAWL",
    "CRAZE",
    "CRAZY",
    "CREAK",
    "CREAM",
    "CREDO",
    "CREED",
    "CREEK",
    "CREEP",
    "CREME",
    "CREPE",
    "CREPT",
    "CRESS",
    "CREST",
    "CRICK",
    "CRIED",
    "CRIER",
    "CRIME",
    "CRIMP",
    "CRISP",
    "CROAK",
    "CROCK",
    "CRONE",
    "CRONY",
    "CROOK",
    "CROSS",
    "CROUP",
    "CROWD",
    "CROWN",
    "CRUDE",
    "CRUEL",
    "CRUMB",
    "CRUMP",
    "CRUSH",
    "CRUST",
    "CRYPT",
    "CUBIC",
    "CUMIN",
    "CURIO",
    "CURLY",
    "CURRY",
    "CURSE",
    "CURVE",
    "CURVY",
    "CUTIE",
    "CYBER",
    "CYCLE",
    "CYNIC",
    "DADDY",
    "DAILY",
    "DAIRY",
    "DAISY",
    "DALLY",
    "DANCE",
    "DANDY",
    "DATUM",
    "DAUNT",
    "DEALT",
    "DEATH",
    "DEBAR",
    "DEBIT",
    "DEBUG",
    "DEBUT",
    "DECAL",
    "DECAY",
    "DECOR",
    "DECOY",
    "DECRY",
    "DEFER",
    "DEIGN",
    "DEITY",
    "DELAY",
    "DELTA",
    "DELVE",
    "DEMON",
    "DEMUR",
    "DENIM",
    "DENSE",
    "DEPOT",
    "DEPTH",
    "DERBY",
    "DETER",
    "DETOX",
    "DEUCE",
    "DEVIL",
    "DIARY",
    "DICEY",
    "DIGIT",
    "DILLY",
    "DIMLY",
    "DINER",
    "DINGO",
    "DINGY",
    "DIODE",
    "DIRGE",
    "DIRTY",
    "DISCO",
    "DITCH",
    "DITTO",
    "DITTY",
    "DIVER",
    "DIZZY",
    "DODGE",
    "DODGY",
    "DOGMA",
    "DOING",
    "DOLLY",
    "DONOR",
    "DONUT",
    "DOPEY",
    "DOUBT",
    "DOUGH",
    "DOWDY",
    "DOWEL",
    "DOWNY",
    "DOWRY",
    "DOZEN",
    "DRAFT",
    "DRAIN",
    "DRAKE",
    "DRAMA",
    "DRANK",
    "DRAPE",
    "DRAWL",
    "DRAWN",
    "DREAD",
    "DREAM",
    "DRESS",
    "DRIED",
    "DRIER",
    "DRIFT",
    "DRILL",
    "DRINK",
    "DRIVE",
    "DROIT",
    "DROLL",
    "DRONE",
    "DROOL",
    "DROOP",
    "DROSS",
    "DROVE",
    "DROWN",
    "DRUID",
    "DRUNK",
    "DRYER",
    "DRYLY",
    "DUCHY",
    "DULLY",
    "DUMMY",
    "DUMPY",
    "DUNCE",
    "DUSKY",
    "DUSTY",
    "DUTCH",
    "DUVET",
    "DWARF",
    "DWELL",
    "DWELT",
    "DYING",
    "EAGER",
    "EAGLE",
    "EARLY",
    "EARTH",
    "EASEL",
    "EATEN",
    "EATER",
    "EBONY",
    "ECLAT",
    "EDICT",
    "EDIFY",
    "EERIE",
    "EGRET",
    "EIGHT",
    "EJECT",
    "EKING",
    "ELATE",
    "ELBOW",
    "ELDER",
    "ELECT",
    "ELEGY",
    "ELFIN",
    "ELIDE",
    "ELITE",
    "ELOPE",
    "ELUDE",
    "EMAIL",
    "EMBED",
    "EMBER",
    "EMCEE",
    "EMPTY",
    "ENACT",
    "ENDOW",
    "ENEMA",
    "ENEMY",
    "ENJOY",
    "ENNUI",
    "ENSUE",
    "ENTER",
    "ENTRY",
    "ENVOY",
    "EPOCH",
    "EPOXY",
    "EQUAL",
    "EQUIP",
    "ERASE",
    "ERECT",
    "ERODE",
    "ERROR",
    "ERUPT",
    "ESSAY",
    "ESTER",
    "ETHER",
    "ETHIC",
    "ETHOS",
    "ETUDE",
    "EVADE",
    "EVENT",
    "EVERY",
    "EVICT",
    "EVOKE",
    "EXACT",
    "EXALT",
    "EXCEL",
    "EXERT",
    "EXILE",
    "EXIST",
    "EXPEL",
    "EXTOL",
    "EXTRA",
    "EXULT",
    "EYING",
    "FABLE",
    "FACET",
    "FAINT",
    "FAIRY",
    "FAITH",
    "FALSE",
    "FANCY",
    "FANNY",
    "FARCE",
    "FATAL",
    "FATTY",
    "FAULT",
    "FAUNA",
    "FAVOR",
    "FEAST",
    "FECAL",
    "FEIGN",
    "FELLA",
    "FELON",
    "FEMME",
    "FEMUR",
    "FENCE",
    "FERAL",
    "FERRY",
    "FETAL",
    "FETCH",
    "FETID",
    "FETUS",
    "FEVER",
    "FEWER",
    "FIBER",
    "FIBRE",
    "FICUS",
    "FIELD",
    "FIEND",
    "FIERY",
    "FIFTH",
    "FIFTY",
    "FIGHT",
    "FILER",
    "FILET",
    "FILLY",
    "FILMY",
    "FILTH",
    "FINAL",
    "FINCH",
    "FINER",
    "FIRST",
    "FISHY",
    "FIXER",
    "FIZZY",
    "FJORD",
    "FLACK",
    "FLAIL",
    "FLAIR",
    "FLAKE",
    "FLAKY",
    "FLAME",
    "FLANK",
    "FLARE",
    "FLASH",
    "FLASK",
    "FLECK",
    "FLEET",
    "FLESH",
    "FLICK",
    "FLIER",
    "FLING",
    "FLINT",
    "FLIRT",
    "FLOAT",
    "FLOCK",
    "FLOOD",
    "FLOOR",
    "FLORA",
    "FLOSS",
    "FLOUR",
    "FLOUT",
    "FLOWN",
    "FLUFF",
    "FLUID",
    "FLUKE",
    "FLUME",
    "FLUNG",
    "FLUNK",
    "FLUSH",
    "FLUTE",
    "FLYER",
    "FOAMY",
    "FOCAL",
    "FOCUS",
    "FOGGY",
    "FOIST",
    "FOLIO",
    "FOLLY",
    "FORAY",
    "FORCE",
    "FORGE",
    "FORGO",
    "FORTE",
    "FORTH",
    "FORTY",
    "FORUM",
    "FOUND",
    "FOYER",
    "FRAIL",
    "FRAME",
    "FRANK",
    "FRAUD",
    "FREAK",
    "FREED",
    "FREER",
    "FRESH",
    "FRIAR",
    "FRIED",
    "FRILL",
    "FRISK",
    "FRITZ",
    "FROCK",
    "FROND",
    "FRONT",
    "FROST",
    "FROTH",
    "FROWN",
    "FROZE",
    "FRUIT",
    "FUDGE",
    "FUGUE",
    "FULLY",
    "FUNGI",
    "FUNKY",
    "FUNNY",
    "FUROR",
    "FURRY",
    "FUSSY",
    "FUZZY",
    "GAFFE",
    "GAILY",
    "GAMER",
    "GAMMA",
    "GAMUT",
    "GASSY",
    "GAUDY",
    "GAUGE",
    "GAUNT",
    "GAUZE",
    "GAVEL",
    "GAWKY",
    "GAYER",
    "GAYLY",
    "GAZER",
    "GECKO",
    "GEEKY",
    "GEESE",
    "GENIE",
    "GENRE",
    "GHOST",
    "GHOUL",
    "GIANT",
    "GIDDY",
    "GIPSY",
    "GIRLY",
    "GIRTH",
    "GIVEN",
    "GIVER",
    "GLADE",
    "GLAND",
    "GLARE",
    "GLASS",
    "GLAZE",
    "GLEAM",
    "GLEAN",
    "GLIDE",
    "GLINT",
    "GLOAT",
    "GLOBE",
    "GLOOM",
    "GLORY",
    "GLOSS",
    "GLOVE",
    "GLYPH",
    "GNASH",
    "GNOME",
    "GODLY",
    "GOING",
    "GOLEM",
    "GOLLY",
    "GONAD",
    "GONER",
    "GOODY",
    "GOOEY",
    "GOOFY",
    "GOOSE",
    "GORGE",
    "GOUGE",
    "GOURD",
    "GRACE",
    "GRADE",
    "GRAFT",
    "GRAIL",
    "GRAIN",
    "GRAND",
    "GRANT",
    "GRAPE",
    "GRAPH",
    "GRASP",
    "GRASS",
    "GRATE",
    "GRAVE",
    "GRAVY",
    "GRAZE",
    "GREAT",
    "GREED",
    "GREEN",
    "GREET",
    "GRIEF",
    "GRILL",
    "GRIME",
    "GRIMY",
    "GRIND",
    "GRIPE",
    "GROAN",
    "GROIN",
    "GROOM",
    "GROPE",
    "GROSS",
    "GROUP",
    "GROUT",
    "GROVE",
    "GROWL",
    "GROWN",
    "GRUEL",
    "GRUFF",
    "GRUNT",
    "GUARD",
    "GUAVA",
    "GUESS",
    "GUEST",
    "GUIDE",
    "GUILD",
    "GUILE",
    "GUILT",
    "GUISE",
    "GULCH",
    "GULLY",
    "GUMBO",
    "GUMMY",
    "GUPPY",
    "GUSTO",
    "GUSTY",
    "GYPSY",
    "HABIT",
    "HAIRY",
    "HALVE",
    "HANDY",
    "HAPPY",
    "HARDY",
    "HAREM",
    "HARPY",
    "HARRY",
    "HARSH",
    "HASTE",
    "HASTY",
    "HATCH",
    "HATER",
    "HAUNT",
    "HAUTE",
    "HAVEN",
    "HAVOC",
    "HAZEL",
    "HEADY",
    "HEARD",
    "HEART",
    "HEATH",
    "HEAVE",
    "HEAVY",
    "HEDGE",
    "HEFTY",
    "HEIST",
    "HELIX",
    "HELLO",
    "HENCE",
    "HERON",
    "HILLY",
    "HINGE",
    "HIPPO",
    "HIPPY",
    "HITCH",
    "HOARD",
    "HOBBY",
    "HOIST",
    "HOLLY",
    "HOMER",
    "HONEY",
    "HONOR",
    "HORDE",
    "HORNY",
    "HORSE",
    "HOTEL",
    "HOTLY",
    "HOUND",
    "HOUSE",
    "HOVEL",
    "HOVER",
    "HOWDY",
    "HUMAN",
    "HUMID",
    "HUMOR",
    "HUMPH",
    "HUMUS",
    "HUNCH",
    "HUNKY",
    "HURRY",
    "HUSKY",
    "HUSSY",
    "HUTCH",
    "HYDRO",
    "HYENA",
    "HYMEN",
    "HYPER",
    "ICILY",
    "ICING",
    "IDEAL",
    "IDIOM",
    "IDIOT",
    "IDLER",
    "IDYLL",
    "IGLOO",
    "ILIAC",
    "IMAGE",
    "IMBUE",
    "IMPEL",
    "IMPLY",
    "INANE",
    "INBOX",
    "INCUR",
    "INDEX",
    "INEPT",
    "INERT",
    "INFER",
    "INGOT",
    "INLAY",
    "INLET",
    "INNER",
    "INPUT",
    "INTER",
    "INTRO",
    "IONIC",
    "IRATE",
    "IRONY",
    "ISLET",
    "ISSUE",
    "ITCHY",
    "IVORY",
    "JAUNT",
    "JAZZY",
    "JELLY",
    "JERKY",
    "JETTY",
    "JEWEL",
    "JIFFY",
    "JOINT",
    "JOIST",
    "JOKER",
    "JOLLY",
    "JOUST",
    "JUDGE",
    "JUICE",
    "JUICY",
    "JUMBO",
    "JUMPY",
    "JUNTA",
    "JUNTO",
    "JUROR",
    "KAPPA",
    "KARMA",
    "KAYAK",
    "KEBAB",
    "KHAKI",
    "KINKY",
    "KIOSK",
    "KITTY",
    "KNACK",
    "KNAVE",
    "KNEAD",
    "KNEED",
    "KNEEL",
    "KNELT",
    "KNIFE",
    "KNOCK",
    "KNOLL",
    "KNOWN",
    "KOALA",
    "KRILL",
    "LABEL",
    "LABOR",
    "LADEN",
    "LADLE",
    "LAGER",
    "LANCE",
    "LANKY",
    "LAPEL",
    "LAPSE",
    "LARGE",
    "LARVA",
    "LASSO",
    "LATCH",
    "LATER",
    "LATHE",
    "LATTE",
    "LAUGH",
    "LAYER",
    "LEACH",
    "LEAFY",
    "LEAKY",
    "LEANT",
    "LEAPT",
    "LEARN",
    "LEASE",
    "LEASH",
    "LEAST",
    "LEAVE",
    "LEDGE",
    "LEECH",
    "LEERY",
    "LEFTY",
    "LEGAL",
    "LEGGY",
    "LEMON",
    "LEMUR",
    "LEPER",
    "LEVEL",
    "LEVER",
    "LIBEL",
    "LIEGE",
    "LIGHT",
    "LIKEN",
    "LILAC",
    "LIMBO",
    "LIMIT",
    "LINEN",
    "LINER",
    "LINGO",
    "LIPID",
    "LITHE",
    "LIVER",
    "LIVID",
    "LLAMA",
    "LOAMY",
    "LOATH",
    "LOBBY",
    "LOCAL",
    "LOCUS",
    "LODGE",
    "LOFTY",
    "LOGIC",
    "LOGIN",
    "LOOPY",
    "LOOSE",
    "LORRY",
    "LOSER",
    "LOUSE",
    "LOUSY",
    "LOVER",
    "LOWER",
    "LOWLY",
    "LOYAL",
    "LUCID",
    "LUCKY",
    "LUMEN",
    "LUMPY",
    "LUNAR",
    "LUNCH",
    "LUNGE",
    "LUPUS",
    "LURCH",
    "LURID",
    "LUSTY",
    "LYING",
    "LYMPH",
    "LYNCH",
    "LYRIC",
    "MACAW",
    "MACHO",
    "MACRO",
    "MADAM",
    "MADLY",
    "MAFIA",
    "MAGIC",
    "MAGMA",
    "MAIZE",
    "MAJOR",
    "MAKER",
    "MAMBO",
    "MAMMA",
    "MAMMY",
    "MANGA",
    "MANGE",
    "MANGO",
    "MANGY",
    "MANIA",
    "MANIC",
    "MANLY",
    "MANOR",
    "MAPLE",
    "MARCH",
    "MARRY",
    "MARSH",
    "MASON",
    "MASSE",
    "MATCH",
    "MATEY",
    "MAUVE",
    "MAXIM",
    "MAYBE",
    "MAYOR",
    "MEALY",
    "MEANT",
    "MEATY",
    "MECCA",
    "MEDAL",
    "MEDIA",
    "MEDIC",
    "MELEE",
    "MELON",
    "MERCY",
    "MERGE",
    "MERIT",
    "MERRY",
    "METAL",
    "METER",
    "METRO",
    "MICRO",
    "MIDGE",
    "MIDST",
    "MIGHT",
    "MILKY",
    "MIMIC",
    "MINCE",
    "MINER",
    "MINIM",
    "MINOR",
    "MINTY",
    "MINUS",
    "MIRTH",
    "MISER",
    "MISSY",
    "MOCHA",
    "MODAL",
    "MODEL",
    "MODEM",
    "MOGUL",
    "MOIST",
    "MOLAR",
    "MOLDY",
    "MONEY",
    "MONTH",
    "MOODY",
    "MOOSE",
    "MORAL",
    "MORON",
    "MORPH",
    "MOSSY",
    "MOTEL",
    "MOTIF",
    "MOTOR",
    "MOTTO",
    "MOULT",
    "MOUND",
    "MOUNT",
    "MOURN",
    "MOUSE",
    "MOUTH",
    "MOVER",
    "MOVIE",
    "MOWER",
    "MUCKY",
    "MUCUS",
    "MUDDY",
    "MULCH",
    "MUMMY",
    "MUNCH",
    "MURAL",
    "MURKY",
    "MUSHY",
    "MUSIC",
    "MUSKY",
    "MUSTY",
    "MYRRH",
    "NADIR",
    "NAIVE",
    "NANNY",
    "NASAL",
    "NASTY",
    "NATAL",
    "NAVAL",
    "NAVEL",
    "NEEDY",
    "NEIGH",
    "NERDY",
    "NERVE",
    "NEVER",
    "NEWER",
    "NEWLY",
    "NICER",
    "NICHE",
    "NIECE",
    "NIGHT",
    "NINJA",
    "NINNY",
    "NINTH",
    "NOBLE",
    "NOBLY",
    "NOISE",
    "NOISY",
    "NOMAD",
    "NOOSE",
    "NORTH",
    "NOSEY",
    "NOTCH",
    "NOVEL",
    "NUDGE",
    "NURSE",
    "NUTTY",
    "NYLON",
    "NYMPH",
    "OAKEN",
    "OBESE",
    "OCCUR",
    "OCEAN",
    "OCTAL",
    "OCTET",
    "ODDER",
    "ODDLY",
    "OFFAL",
    "OFFER",
    "OFTEN",
    "OLDEN",
    "OLDER",
    "OLIVE",
    "OMBRE",
    "OMEGA",
    "ONION",
    "ONSET",
    "OPERA",
    "OPINE",
    "OPIUM",
    "OPTIC",
    "ORBIT",
    "ORDER",
    "ORGAN",
    "OTHER",
    "OTTER",
    "OUGHT",
    "OUNCE",
    "OUTDO",
    "OUTER",
    "OUTGO",
    "OVARY",
    "OVATE",
    "OVERT",
    "OVINE",
    "OVOID",
    "OWING",
    "OWNER",
    "OXIDE",
    "OZONE",
    "PADDY",
    "PAGAN",
    "PAINT",
    "PALER",
    "PALSY",
    "PANEL",
    "PANIC",
    "PANSY",
    "PAPAL",
    "PAPER",
    "PARER",
    "PARKA",
    "PARRY",
    "PARSE",
    "PARTY",
    "PASTA",
    "PASTE",
    "PASTY",
    "PATCH",
    "PATIO",
    "PATSY",
    "PATTY",
    "PAUSE",
    "PAYEE",
    "PAYER",
    "PEACE",
    "PEACH",
    "PEARL",
    "PECAN",
    "PEDAL",
    "PENAL",
    "PENCE",
    "PENNE",
    "PENNY",
    "PERCH",
    "PERIL",
    "PERKY",
    "PESKY",
    "PESTO",
    "PETAL",
    "PETTY",
    "PHASE",
    "PHONE",
    "PHONY",
    "PHOTO",
    "PIANO",
    "PICKY",
    "PIECE",
    "PIETY",
    "PIGGY",
    "PILOT",
    "PINCH",
    "PINEY",
    "PINKY",
    "PINTO",
    "PIPER",
    "PIQUE",
    "PITCH",
    "PITHY",
    "PIVOT",
    "PIXEL",
    "PIXIE",
    "PIZZA",
    "PLACE",
    "PLAID",
    "PLAIN",
    "PLAIT",
    "PLANE",
    "PLANK",
    "PLANT",
    "PLATE",
    "PLAZA",
    "PLEAD",
    "PLEAT",
    "PLIED",
    "PLIER",
    "PLUCK",
    "PLUMB",
    "PLUME",
    "PLUMP",
    "PLUNK",
    "PLUSH",
    "POESY",
    "POINT",
    "POISE",
    "POKER",
    "POLAR",
    "POLKA",
    "POLYP",
    "POOCH",
    "POPPY",
    "PORCH",
    "POSER",
    "POSIT",
    "POSSE",
    "POUCH",
    "POUND",
    "POUTY",
    "POWER",
    "PRANK",
    "PRAWN",
    "PREEN",
    "PRESS",
    "PRICE",
    "PRICK",
    "PRIDE",
    "PRIED",
    "PRIME",
    "PRIMO",
    "PRINT",
    "PRIOR",
    "PRISM",
    "PRIVY",
    "PRIZE",
    "PROBE",
    "PRONE",
    "PRONG",
    "PROOF",
    "PROSE",
    "PROUD",
    "PROVE",
    "PROWL",
    "PROXY",
    "PRUDE",
    "PRUNE",
    "PSALM",
    "PUBIC",
    "PUDGY",
    "PUFFY",
    "PULPY",
    "PULSE",
    "PUNCH",
    "PUPAL",
    "PUPIL",
    "PUPPY",
    "PUREE",
    "PURER",
    "PURGE",
    "PURSE",
    "PUSHY",
    "PUTTY",
    "PYGMY",
    "QUACK",
    "QUAIL",
    "QUAKE",
    "QUALM",
    "QUARK",
    "QUART",
    "QUASH",
    "QUASI",
    "QUEEN",
    "QUEER",
    "QUELL",
    "QUERY",
    "QUEST",
    "QUEUE",
    "QUICK",
    "QUIET",
    "QUILL",
    "QUILT",
    "QUIRK",
    "QUITE",
    "QUOTA",
    "QUOTE",
    "QUOTH",
    "RABBI",
    "RABID",
    "RACER",
    "RADAR",
    "RADII",
    "RADIO",
    "RAINY",
    "RAISE",
    "RAJAH",
    "RALLY",
    "RALPH",
    "RAMEN",
    "RANCH",
    "RANDY",
    "RANGE",
    "RAPID",
    "RARER",
    "RASPY",
    "RATIO",
    "RATTY",
    "RAVEN",
    "RAYON",
    "RAZOR",
    "REACH",
    "REACT",
    "READY",
    "REALM",
    "REARM",
    "REBAR",
    "REBEL",
    "REBUS",
    "REBUT",
    "RECAP",
    "RECUR",
    "RECUT",
    "REEDY",
    "REFER",
    "REFIT",
    "REGAL",
    "REHAB",
    "REIGN",
    "RELAX",
    "RELAY",
    "RELIC",
    "REMIT",
    "RENAL",
    "RENEW",
    "REPAY",
    "REPEL",
    "REPLY",
    "RERUN",
    "RESET",
    "RESIN",
    "RETCH",
    "RETRO",
    "RETRY",
    "REUSE",
    "REVEL",
    "REVUE",
    "RHINO",
    "RHYME",
    "RIDER",
    "RIDGE",
    "RIFLE",
    "RIGHT",
    "RIGID",
    "RIGOR",
    "RINSE",
    "RIPEN",
    "RIPER",
    "RISEN",
    "RISER",
    "RISKY",
    "RIVAL",
    "RIVER",
    "RIVET",
    "ROACH",
    "ROAST",
    "ROBIN",
    "ROBOT",
    "ROCKY",
    "RODEO",
    "ROGER",
    "ROGUE",
    "ROOMY",
    "ROOST",
    "ROTOR",
    "ROUGE",
    "ROUGH",
    "ROUND",
    "ROUSE",
    "ROUTE",
    "ROVER",
    "ROWDY",
    "ROWER",
    "ROYAL",
    "RUDDY",
    "RUDER",
    "RUGBY",
    "RULER",
    "RUMBA",
    "RUMOR",
    "RUPEE",
    "RURAL",
    "RUSTY",
    "SADLY",
    "SAFER",
    "SAINT",
    "SALAD",
    "SALLY",
    "SALON",
    "SALSA",
    "SALTY",
    "SALVE",
    "SALVO",
    "SANDY",
    "SANER",
    "SAPPY",
    "SASSY",
    "SATIN",
    "SATYR",
    "SAUCE",
    "SAUCY",
    "SAUNA",
    "SAUTE",
    "SAVOR",
    "SAVOY",
    "SAVVY",
    "SCALD",
    "SCALE",
    "SCALP",
    "SCALY",
    "SCAMP",
    "SCANT",
    "SCARE",
    "SCARF",
    "SCARY",
    "SCENE",
    "SCENT",
    "SCION",
    "SCOFF",
    "SCOLD",
    "SCONE",
    "SCOOP",
    "SCOPE",
    "SCORE",
    "SCORN",
    "SCOUR",
    "SCOUT",
    "SCOWL",
    "SCRAM",
    "SCRAP",
    "SCREE",
    "SCREW",
    "SCRUB",
    "SCRUM",
    "SCUBA",
    "SEDAN",
    "SEEDY",
    "SEGUE",
    "SEIZE",
    "SEMEN",
    "SENSE",
    "SEPIA",
    "SERIF",
    "SERUM",
    "SERVE",
    "SETUP",
    "SEVEN",
    "SEVER",
    "SEWER",
    "SHACK",
    "SHADE",
    "SHADY",
    "SHAFT",
    "SHAKE",
    "SHAKY",
    "SHALE",
    "SHALL",
    "SHALT",
    "SHAME",
    "SHANK",
    "SHAPE",
    "SHARD",
    "SHARE",
    "SHARK",
    "SHARP",
    "SHAVE",
    "SHAWL",
    "SHEAR",
    "SHEEN",
    "SHEEP",
    "SHEER",
    "SHEET",
    "SHEIK",
    "SHELF",
    "SHELL",
    "SHIED",
    "SHIFT",
    "SHINE",
    "SHINY",
    "SHIRE",
    "SHIRK",
    "SHIRT",
    "SHOAL",
    "SHOCK",
    "SHONE",
    "SHOOK",
    "SHOOT",
    "SHORE",
    "SHORN",
    "SHORT",
    "SHOUT",
    "SHOVE",
    "SHOWN",
    "SHOWY",
    "SHREW",
    "SHRUB",
    "SHRUG",
    "SHUCK",
    "SHUNT",
    "SHUSH",
    "SHYLY",
    "SIEGE",
    "SIEVE",
    "SIGHT",
    "SIGMA",
    "SILKY",
    "SILLY",
    "SINCE",
    "SINEW",
    "SINGE",
    "SIREN",
    "SISSY",
    "SIXTH",
    "SIXTY",
    "SKATE",
    "SKIER",
    "SKIFF",
    "SKILL",
    "SKIMP",
    "SKIRT",
    "SKULK",
    "SKULL",
    "SKUNK",
    "SLACK",
    "SLAIN",
    "SLANG",
    "SLANT",
    "SLASH",
    "SLATE",
    "SLAVE",
    "SLEEK",
    "SLEEP",
    "SLEET",
    "SLEPT",
    "SLICE",
    "SLICK",
    "SLIDE",
    "SLIME",
    "SLIMY",
    "SLING",
    "SLINK",
    "SLOOP",
    "SLOPE",
    "SLOSH",
    "SLOTH",
    "SLUMP",
    "SLUNG",
    "SLUNK",
    "SLURP",
    "SLUSH",
    "SLYLY",
    "SMACK",
    "SMALL",
    "SMART",
    "SMASH",
    "SMEAR",
    "SMELL",
    "SMELT",
    "SMILE",
    "SMIRK",
    "SMITE",
    "SMITH",
    "SMOCK",
    "SMOKE",
    "SMOKY",
    "SMOTE",
    "SNACK",
    "SNAIL",
    "SNAKE",
    "SNAKY",
    "SNARE",
    "SNARL",
    "SNEAK",
    "SNEER",
    "SNIDE",
    "SNIFF",
    "SNIPE",
    "SNOOP",
    "SNORE",
    "SNORT",
    "SNOUT",
    "SNOWY",
    "SNUCK",
    "SNUFF",
    "SOAPY",
    "SOBER",
    "SOGGY",
    "SOLAR",
    "SOLID",
    "SOLVE",
    "SONAR",
    "SONIC",
    "SOOTH",
    "SOOTY",
    "SORRY",
    "SOUND",
    "SOUTH",
    "SOWER",
    "SPACE",
    "SPADE",
    "SPANK",
    "SPARE",
    "SPARK",
    "SPASM",
    "SPAWN",
    "SPEAK",
    "SPEAR",
    "SPECK",
    "SPEED",
    "SPELL",
    "SPELT",
    "SPEND",
    "SPENT",
    "SPERM",
    "SPICE",
    "SPICY",
    "SPIED",
    "SPIEL",
    "SPIKE",
    "SPIKY",
    "SPILL",
    "SPILT",
    "SPINE",
    "SPINY",
    "SPIRE",
    "SPITE",
    "SPLAT",
    "SPLIT",
    "SPOIL",
    "SPOKE",
    "SPOOF",
    "SPOOK",
    "SPOOL",
    "SPOON",
    "SPORE",
    "SPORT",
    "SPOUT",
    "SPRAY",
    "SPREE",
    "SPRIG",
    "SPUNK",
    "SPURN",
    "SPURT",
    "SQUAD",
    "SQUAT",
    "SQUIB",
    "STACK",
    "STAFF",
    "STAGE",
    "STAID",
    "STAIN",
    "STAIR",
    "STAKE",
    "STALE",
    "STALK",
    "STALL",
    "STAMP",
    "STAND",
    "STANK",
    "STARE",
    "STARK",
    "START",
    "STASH",
    "STATE",
    "STAVE",
    "STEAD",
    "STEAK",
    "STEAL",
    "STEAM",
    "STEED",
    "STEEL",
    "STEEP",
    "STEER",
    "STEIN",
    "STERN",
    "STICK",
    "STIFF",
    "STILL",
    "STILT",
    "STING",
    "STINK",
    "STINT",
    "STOCK",
    "STOIC",
    "STOKE",
    "STOLE",
    "STOMP",
    "STONE",
    "STONY",
    "STOOD",
    "STOOL",
    "STOOP",
    "STORE",
    "STORK",
    "STORM",
    "STORY",
    "STOUT",
    "STOVE",
    "STRAP",
    "STRAW",
    "STRAY",
    "STRIP",
    "STRUT",
    "STUCK",
    "STUDY",
    "STUFF",
    "STUMP",
    "STUNG",
    "STUNK",
    "STUNT",
    "STYLE",
    "SUAVE",
    "SUGAR",
    "SUING",
    "SUITE",
    "SULKY",
    "SULLY",
    "SUMAC",
    "SUNNY",
    "SUPER",
    "SURER",
    "SURGE",
    "SURLY",
    "SUSHI",
    "SWAMI",
    "SWAMP",
    "SWARM",
    "SWASH",
    "SWATH",
    "SWEAR",
    "SWEAT",
    "SWEEP",
    "SWEET",
    "SWELL",
    "SWEPT",
    "SWIFT",
    "SWILL",
    "SWINE",
    "SWING",
    "SWIRL",
    "SWISH",
    "SWOON",
    "SWOOP",
    "SWORD",
    "SWORE",
    "SWORN",
    "SWUNG",
    "SYNOD",
    "SYRUP",
    "TABBY",
    "TABLE",
    "TABOO",
    "TACIT",
    "TACKY",
    "TAFFY",
    "TAINT",
    "TAKEN",
    "TAKER",
    "TALLY",
    "TALON",
    "TAMER",
    "TANGO",
    "TANGY",
    "TAPER",
    "TAPIR",
    "TARDY",
    "TAROT",
    "TASTE",
    "TASTY",
    "TATTY",
    "TAUNT",
    "TAWNY",
    "TEACH",
    "TEARY",
    "TEASE",
    "TEDDY",
    "TEETH",
    "TEMPO",
    "TENET",
    "TENOR",
    "TENSE",
    "TENTH",
    "TEPEE",
    "TEPID",
    "TERRA",
    "TERSE",
    "TESTY",
    "THANK",
    "THEFT",
    "THEIR",
    "THEME",
    "THERE",
    "THESE",
    "THETA",
    "THICK",
    "THIEF",
    "THIGH",
    "THING",
    "THINK",
    "THIRD",
    "THONG",
    "THORN",
    "THOSE",
    "THREE",
    "THREW",
    "THROB",
    "THROW",
    "THRUM",
    "THUMB",
    "THUMP",
    "THYME",
    "TIARA",
    "TIBIA",
    "TIDAL",
    "TIGER",
    "TIGHT",
    "TILDE",
    "TIMER",
    "TIMID",
    "TIPSY",
    "TITAN",
    "TITHE",
    "TITLE",
    "TOAST",
    "TODAY",
    "TODDY",
    "TOKEN",
    "TONAL",
    "TONGA",
    "TONIC",
    "TOOTH",
    "TOPAZ",
    "TOPIC",
    "TORCH",
    "TORSO",
    "TORUS",
    "TOTAL",
    "TOTEM",
    "TOUCH",
    "TOUGH",
    "TOWEL",
    "TOWER",
    "TOXIC",
    "TOXIN",
    "TRACE",
    "TRACK",
    "TRACT",
    "TRADE",
    "TRAIL",
    "TRAIN",
    "TRAIT",
    "TRAMP",
    "TRASH",
    "TRAWL",
    "TREAD",
    "TREAT",
    "TREND",
    "TRIAD",
    "TRIAL",
    "TRIBE",
    "TRICE",
    "TRICK",
    "TRIED",
    "TRIPE",
    "TRITE",
    "TROLL",
    "TROOP",
    "TROPE",
    "TROUT",
    "TROVE",
    "TRUCE",
    "TRUCK",
    "TRUER",
    "TRULY",
    "TRUMP",
    "TRUNK",
    "TRUSS",
    "TRUST",
    "TRUTH",
    "TRYST",
    "TUBAL",
    "TUBER",
    "TULIP",
    "TULLE",
    "TUMOR",
    "TUNIC",
    "TURBO",
    "TUTOR",
    "TWANG",
    "TWEAK",
    "TWEED",
    "TWEET",
    "TWICE",
    "TWINE",
    "TWIRL",
    "TWIST",
    "TWIXT",
    "TYING",
    "UDDER",
    "ULCER",
    "ULTRA",
    "UMBRA",
    "UNCLE",
    "UNCUT",
    "UNDER",
    "UNDID",
    "UNDUE",
    "UNFED",
    "UNFIT",
    "UNIFY",
    "UNION",
    "UNITE",
    "UNITY",
    "UNLIT",
    "UNMET",
    "UNSET",
    "UNTIE",
    "UNTIL",
    "UNWED",
    "UNZIP",
    "UPPER",
    "UPSET",
    "URBAN",
    "URINE",
    "USAGE",
    "USHER",
    "USING",
    "USUAL",
    "USURP",
    "UTILE",
    "UTTER",
    "VAGUE",
    "VALET",
    "VALID",
    "VALOR",
    "VALUE",
    "VALVE",
    "VAPID",
    "VAPOR",
    "VAULT",
    "VAUNT",
    "VEGAN",
    "VENOM",
    "VENUE",
    "VERGE",
    "VERSE",
    "VERSO",
    "VERVE",
    "VICAR",
    "VIDEO",
    "VIGIL",
    "VIGOR",
    "VILLA",
    "VINYL",
    "VIOLA",
    "VIPER",
    "VIRAL",
    "VIRUS",
    "VISIT",
    "VISOR",
    "VISTA",
    "VITAL",
    "VIVID",
    "VIXEN",
    "VOCAL",
    "VODKA",
    "VOGUE",
    "VOICE",
    "VOILA",
    "VOMIT",
    "VOTER",
    "VOUCH",
    "VOWEL",
    "VYING",
    "WACKY",
    "WAFER",
    "WAGER",
    "WAGON",
    "WAIST",
    "WAIVE",
    "WALTZ",
    "WARTY",
    "WASTE",
    "WATCH",
    "WATER",
    "WAVER",
    "WAXEN",
    "WEARY",
    "WEAVE",
    "WEDGE",
    "WEEDY",
    "WEIGH",
    "WEIRD",
    "WELCH",
    "WELSH",
    "WENCH",
    "WHACK",
    "WHALE",
    "WHARF",
    "WHEAT",
    "WHEEL",
    "WHELP",
    "WHERE",
    "WHICH",
    "WHIFF",
    "WHILE",
    "WHINE",
    "WHINY",
    "WHIRL",
    "WHISK",
    "WHITE",
    "WHOLE",
    "WHOOP",
    "WHOSE",
    "WIDEN",
    "WIDER",
    "WIDOW",
    "WIDTH",
    "WIELD",
    "WIGHT",
    "WILLY",
    "WIMPY",
    "WINCE",
    "WINCH",
    "WINDY",
    "WISER",
    "WISPY",
    "WITCH",
    "WITTY",
    "WOKEN",
    "WOMAN",
    "WOMEN",
    "WOODY",
    "WOOER",
    "WOOLY",
    "WOOZY",
    "WORDY",
    "WORLD",
    "WORRY",
    "WORSE",
    "WORST",
    "WORTH",
    "WOULD",
    "WOUND",
    "WOVEN",
    "WRACK",
    "WRATH",
    "WREAK",
    "WRECK",
    "WREST",
    "WRING",
    "WRIST",
    "WRITE",
    "WRONG",
    "WROTE",
    "WRUNG",
    "WRYLY",
    "YACHT",
    "YEARN",
    "YEAST",
    "YIELD",
    "YOUNG",
    "YOUTH",
    "ZEBRA",
    "ZESTY",
    "ZONAL"
];


// กรองคำเอาเฉพาะคำที่มีความยาวตรงกับ WORD_LENGTH

// ตรวจสอบว่าคำพิมพ์ใหญ่ด้วย filter อีกครั้งเพื่อความชัวร์ (ถ้า words.txt อาจมีพิมพ์เล็ก)

const fiveLetterWords: string[] = ALL_WORDS.filter((word: string) => word.length === WORD_LENGTH && word === word.toUpperCase());

// --- Game Initialization ---

function initializeGame(): void {

// --- เพิ่มการตรวจสอบตรงนี้ ---

if (fiveLetterWords.length === 0) {

console.error("Error: No 5-letter words found in the word list (fiveLetterWords is empty). Please ensure your data/words.txt contains 5-letter words and you've run 'npm run generate-wordlist'.");

showMessage("เกิดข้อผิดพลาด: ไม่พบคำศัพท์ 5 ตัวอักษรในคลัง!", false);

gameEnded = true; // ตั้งสถานะให้เกมจบเพื่อไม่ให้เล่นต่อ

newGameButton.textContent = 'Check Word List'; // เปลี่ยนข้อความปุ่มเพื่อแจ้งปัญหา

newGameButton.style.display = 'block'; // แสดงปุ่มเพื่อให้ผู้ใช้เห็นข้อความ

return; // หยุดการทำงานของฟังก์ชัน initializeGame ถ้าไม่มีคำศัพท์

}

// ----------------------------

// สุ่มเลือกคำลับจากคลังคำศัพท์ 5 ตัวอักษร

secretWord = fiveLetterWords[Math.floor(Math.random() * fiveLetterWords.length)];

// รีเซ็ตสถานะเกม

currentGuess = '';

currentRow = 0;

gameEnded = false;

// ตั้งค่าข้อความปุ่มและซ่อน

newGameButton.textContent = 'Play Again';

newGameButton.style.display = 'none';

// ล้างและซ่อนข้อความแจ้งเตือน

messageEl.textContent = '';

messageEl.classList.remove('show');

// ล้างกระดานเดาคำและสร้างช่องใหม่

guessesEl.innerHTML = '';

for (let i = 0; i < MAX_GUESSES; i++) {

const row: HTMLDivElement = document.createElement('div');

row.classList.add('row');

for (let j = 0; j < WORD_LENGTH; j++) {

const box: HTMLDivElement = document.createElement('div');

box.classList.add('box');

row.appendChild(box);

}

guessesEl.appendChild(row);

}

// รีเซ็ตสีของปุ่มบนแป้นพิมพ์

const keys: NodeListOf<HTMLButtonElement> = document.querySelectorAll('.key');

keys.forEach((key: HTMLButtonElement) => {

key.classList.remove('correct', 'present', 'absent');

});

console.log("Secret word:", secretWord); // สำหรับ Debugging เท่านั้น! (แนะนำให้ลบออกในเวอร์ชันจริง)

}

// --- Keyboard Creation ---

function createKeyboard(): void {

const layout: string[][] = [

['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],

['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],

['ENTER', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', 'BACKSPACE']

];

keyboardEl.innerHTML = ''; // ล้างแป้นพิมพ์เก่า

layout.forEach((rowKeys: string[]) => {

const rowDiv: HTMLDivElement = document.createElement('div');

rowDiv.style.display = 'flex';

rowDiv.style.justifyContent = 'center';

// rowDiv.style.marginBottom = '5px'; // ถูกแทนที่ด้วย gap ใน #keyboard CSS

rowKeys.forEach((keyText: string) => {

const keyButton: HTMLButtonElement = document.createElement('button');

keyButton.classList.add('key');

keyButton.textContent = keyText;

keyButton.setAttribute('data-key', keyText); // สำคัญสำหรับการอัปเดตสี

// ปรับ class สำหรับปุ่ม Enter และ Backspace

if (keyText === 'ENTER') {

keyButton.classList.add('enter');

} else if (keyText === 'BACKSPACE') {

keyButton.classList.add('backspace');

}

keyButton.addEventListener('click', () => handleKeyPress(keyText));

rowDiv.appendChild(keyButton);

});

keyboardEl.appendChild(rowDiv);

});

}

// --- Board Update ---

function updateBoard(): void {

const rows = guessesEl.children as HTMLCollectionOf<HTMLDivElement>;

const currentRowBoxes = rows[currentRow].children as HTMLCollectionOf<HTMLDivElement>;

for (let i = 0; i < WORD_LENGTH; i++) {

const box = currentRowBoxes[i];

box.textContent = currentGuess[i] || ''; // แสดงตัวอักษรในช่อง

// เพิ่มหรือลบ class 'filled' สำหรับ animation

if (currentGuess[i]) {

box.classList.add('filled');

} else {

box.classList.remove('filled');

}

}

// Trigger pop animation for the last typed character

const lastBoxIndex = currentGuess.length - 1;

if (lastBoxIndex >= 0 && lastBoxIndex < WORD_LENGTH) {

const lastBox = currentRowBoxes[lastBoxIndex];

lastBox.classList.add('active');

// ลบ class 'active' ออกหลังจาก animation จบ (เพื่อให้สามารถ trigger ใหม่ได้)

setTimeout(() => lastBox.classList.remove('active'), 100);

}

}

// --- Handle User Input ---

function handleKeyPress(key: string): void {

if (gameEnded) return; // ไม่รับ input ถ้าเกมจบแล้ว

if (key === 'ENTER') {

checkGuess();

} else if (key === 'BACKSPACE') {

currentGuess = currentGuess.slice(0, -1); // ลบตัวอักษรสุดท้าย

updateBoard();

} else if (currentGuess.length < WORD_LENGTH && key.length === 1 && key.match(/[A-Z]/)) {

// เพิ่มตัวอักษรเฉพาะถ้าเป็นตัวอักษร A-Z และคำยังไม่ครบ 5 ตัว

currentGuess += key;

updateBoard();

}

}

// --- Game Logic: Check Guess ---

async function checkGuess(): Promise<void> {

// 1. ตรวจสอบความยาวของคำที่เดา

if (currentGuess.length !== WORD_LENGTH) {

showMessage("คำต้องมี " + WORD_LENGTH + " ตัวอักษร!", true);

return; // สำคัญ: หยุดการทำงานทันที

}

// 2. ตรวจสอบว่าคำที่เดาอยู่ในคลังคำศัพท์ที่อนุญาตหรือไม่

if (!fiveLetterWords.includes(currentGuess)) {

showMessage("ไม่ใช่คำในพจนานุกรม!", true);

return; // สำคัญ: หยุดการทำงานทันที

}

const rows = guessesEl.children as HTMLCollectionOf<HTMLDivElement>;

const currentRowBoxes = rows[currentRow].children as HTMLCollectionOf<HTMLDivElement>;

// สร้างสำเนาของคำลับเพื่อใช้ในการตรวจสอบ (เพราะจะมีการลบตัวอักษรที่ใช้ไปแล้ว)

const secretWordArray: (string | null)[] = secretWord.split('');

const guessArray: string[] = currentGuess.split('');

// --- First Pass: Check for correct positions (Green) ---

// ตัวอักษรที่ถูกต้องและอยู่ในตำแหน่งที่ถูกต้อง

for (let i = 0; i < WORD_LENGTH; i++) {

if (guessArray[i] === secretWordArray[i]) {

currentRowBoxes[i].classList.add('correct');

updateKeyboardKey(guessArray[i], 'correct');

secretWordArray[i] = null; // Mark as used (เพื่อไม่ให้ถูกนับซ้ำใน Present)

}

}

// --- Second Pass: Check for present letters (Yellow) ---

// ตัวอักษรที่อยู่ในคำลับ แต่ผิดตำแหน่ง

for (let i = 0; i < WORD_LENGTH; i++) {

// ถ้ายังไม่ได้ถูกทำเครื่องหมายเป็น 'correct' ในรอบแรก

if (!currentRowBoxes[i].classList.contains('correct')) {

const indexInSecret = secretWordArray.indexOf(guessArray[i]);

if (indexInSecret !== -1) {

// พบตัวอักษรในคำลับ แต่ไม่ใช่ตำแหน่งที่ถูกต้อง

currentRowBoxes[i].classList.add('present');

updateKeyboardKey(guessArray[i], 'present');

secretWordArray[indexInSecret] = null; // Mark as used

} else {

// ไม่พบตัวอักษรในคำลับเลย

currentRowBoxes[i].classList.add('absent');

updateKeyboardKey(guessArray[i], 'absent');

}

}

}

// --- Check Game End Conditions ---

if (currentGuess === secretWord) {

showMessage("เยี่ยม! คุณทายถูก!", false); // แสดงถาวรจนกว่าจะเริ่มเกมใหม่

gameEnded = true;

newGameButton.style.display = 'block';

} else {

currentRow++; // ไปยังแถวถัดไป

currentGuess = ''; // รีเซ็ตคำเดาปัจจุบัน

if (currentRow >= MAX_GUESSES) {

showMessage(`คุณแพ้แล้ว! คำที่ถูกต้องคือ "${secretWord}"`, false); // แสดงถาวร

gameEnded = true;

newGameButton.style.display = 'block';

}

}

}

// --- Helper: Update Keyboard Key Colors ---

function updateKeyboardKey(keyChar: string, status: 'correct' | 'present' | 'absent'): void {

const keyElement = document.querySelector(`button.key[data-key="${keyChar}"]`) as HTMLButtonElement | null;

if (keyElement) {

// ตรรกะการจัดลำดับความสำคัญของสี: Correct (เขียว) > Present (เหลือง) > Absent (เทา)

if (keyElement.classList.contains('correct')) {

// ถ้าเป็นสีเขียวอยู่แล้ว ไม่ต้องทำอะไรอีก

return;

} else if (keyElement.classList.contains('present') && status === 'correct') {

// ถ้าเป็นสีเหลือง แต่ตอนนี้ควรเป็นสีเขียว -> เปลี่ยนเป็นเขียว

keyElement.classList.remove('present');

keyElement.classList.add('correct');

} else if (!keyElement.classList.contains('present') && status === 'present') {

// ถ้ายังไม่ใช่สีเหลืองและสีเขียว แต่ตอนนี้ควรเป็นสีเหลือง -> เปลี่ยนเป็นเหลือง

keyElement.classList.add('present');

} else if (status === 'absent' && !keyElement.classList.contains('present') && !keyElement.classList.contains('correct')) {

// ถ้ายังไม่มีสีเลย และตอนนี้ควรเป็นสีเทา -> เปลี่ยนเป็นเทา

keyElement.classList.add('absent');

}

}

}

// --- Helper: Show Message ---

// autoHide: true = ซ่อนอัตโนมัติหลังจาก 2 วินาที, false = แสดงค้างไว้

function showMessage(message: string, autoHide: boolean): void {

messageEl.textContent = message;

messageEl.classList.add('show');

if (autoHide) {

setTimeout(() => {

messageEl.classList.remove('show');

// คุณอาจจะเลือกให้ข้อความหายไปเลย หรือแค่ซ่อน class 'show' เพื่อให้ animation ทำงาน

// messageEl.textContent = '';

}, 2000); // ซ่อนหลังจาก 2 วินาที

}

}

// --- Event Listeners ---

// สำหรับการพิมพ์จากแป้นพิมพ์จริง

document.addEventListener('keydown', (event: KeyboardEvent) => {

const key = event.key.toUpperCase(); // แปลงเป็นตัวพิมพ์ใหญ่

// ตรวจสอบว่าไม่ได้กด F12 หรือ F5 เพื่อป้องกันการขัดแย้งกับ hotkeys อื่นๆ

if (!event.altKey && !event.ctrlKey && !event.metaKey) {

handleKeyPress(key);

}

});

// สำหรับปุ่ม "เล่นใหม่"

newGameButton.addEventListener('click', initializeGame);

// --- Initial Setup on Load ---

createKeyboard();

initializeGame();